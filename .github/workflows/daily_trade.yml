name: 开盘反弹策略监控流

on:
  schedule:
    # 这里的 Cron 表达式代表：周一至周五，UTC 时间 14:25 (对应美东 09:25)
    - cron: '25 14 * * 1-5'
  workflow_dispatch: # 允许手动点击按钮启动

jobs:
  run-monitor:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'  # <--- 从 3.13 改为 3.10，这是目前兼容性最稳的版本

      - name: Install dependencies
        run: |
          pip install longport-openapi requests pytz

      - name: Run Script
        env:
          # 将 GitHub Secrets 映射为脚本能识别的环境变量
          LONGPORT_APP_KEY: ${{ secrets.LONGPORT_APP_KEY }}
          LONGPORT_APP_SECRET: ${{ secrets.LONGPORT_APP_SECRET }}
          LONGPORT_ACCESS_TOKEN: ${{ secrets.LONGPORT_ACCESS_TOKEN }}
        run: python main/firstbar_bo_longport.py